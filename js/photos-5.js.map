{"version":3,"file":"photos-5.js?v=f6a067226fab7bbe00a2","sources":["webpack:///./src/components/Loader.vue?1cb4","webpack:///./src/components/SeparatorVirtualGrid.vue?8517","webpack:///./src/views/Timeline.vue?9e76","webpack:///./src/components/Loader.vue?6e38","webpack:///./src/components/SeparatorVirtualGrid.vue?288a","webpack:///./src/views/Timeline.vue?8a4c","webpack:///./src/components/Loader.vue?8d96","webpack:///./src/components/SeparatorVirtualGrid.vue?39cf","webpack:///./src/views/Timeline.vue?1084","webpack:///./src/components/Loader.vue?cd6e","webpack:///./src/components/SeparatorVirtualGrid.vue?85ee","webpack:///./src/views/Timeline.vue?4e14","webpack:///./src/components/Loader.vue","webpack:///./src/components/Loader.vue?fc6a","webpack:///./src/components/Loader.vue?a782","webpack:///./src/components/Loader.vue?d6c2","webpack:///./src/components/SeparatorVirtualGrid.vue","webpack:///./src/components/SeparatorVirtualGrid.vue?725b","webpack:///./src/components/SeparatorVirtualGrid.vue?1321","webpack:///./src/components/SeparatorVirtualGrid.vue?e7f2","webpack:///./src/patchedRequest.js","webpack:///./src/services/DavClient.js","webpack:///./src/services/DavRequest.js","webpack:///./src/services/PhotoSearch.js","webpack:///./src/views/Timeline.vue","webpack:///./src/views/Timeline.vue?a7b1","webpack:///./src/views/Timeline.vue?e469","webpack:///./src/views/Timeline.vue?3f3f"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: 'Loader'\n};","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: 'SeparatorVirtualGrid',\n  inheritAttrs: false,\n  props: {\n    item: {\n      type: Object,\n      required: true\n    }\n  }\n};","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as moment from 'moment';\nimport { mapGetters } from 'vuex';\nimport getPhotos from '../services/PhotoSearch';\nimport EmptyContent from '../components/EmptyContent';\nimport File from '../components/File';\nimport SeparatorVirtualGrid from '../components/SeparatorVirtualGrid';\nimport VirtualGrid from 'vue-virtual-grid';\nimport Navigation from '../components/Navigation';\nimport Loader from '../components/Loader';\nimport cancelableRequest from '../utils/CancelableRequest';\nimport GridConfigMixin from '../mixins/GridConfig';\nimport { allMimes } from '../services/AllowedMimes';\nexport default {\n  name: 'Timeline',\n  components: {\n    EmptyContent,\n    VirtualGrid,\n    Navigation\n  },\n  mixins: [GridConfigMixin],\n  props: {\n    loading: {\n      type: Boolean,\n      required: true\n    },\n    onlyFavorites: {\n      type: Boolean,\n      default: false\n    },\n    mimesType: {\n      type: Array,\n      default: () => allMimes\n    },\n    rootTitle: {\n      type: String,\n      required: true\n    },\n    path: {\n      type: String,\n      default: ''\n    }\n  },\n\n  data() {\n    return {\n      cancelRequest: null,\n      done: false,\n      error: null,\n      page: 0,\n      lastSection: '',\n      loaderComponent: Loader\n    };\n  },\n\n  computed: { // global lists\n    ...mapGetters(['files', 'timeline']),\n\n    // list of loaded medias\n    fileList() {\n      return this.timeline.map(fileId => this.files[fileId]);\n    },\n\n    // list of displayed content in the grid (titles + medias)\n    contentList() {\n      /** The goal of this flat map is to return an array of images separated by titles (months)\n       * ie: [{month1}, {image1}, {image2}, {month2}, {image3}, {image4}, {image5}]\n       * First we get the current month+year of the image\n       * We compare it to the previous image month+year\n       * If there is a difference we have to insert a title object before the current image\n       * If it's equal we just add the current image to the array\n       * Note: the injected param of objects are used to pass custom params to the grid lib\n       * In our case injected could be an image/video (aka file) or a title (year/month)\n       * Note2: titles are rendered full width and images are rendered on 1 column and 256x256 ratio\n       */\n      return this.fileList.flatMap((file, index) => {\n        const finalArray = [];\n        const currentSection = this.getFormatedDate(file.lastmod, 'YYYY MMMM');\n\n        if (this.lastSection !== currentSection) {\n          finalArray.push({\n            id: \"title-\".concat(index),\n            injected: {\n              year: this.getFormatedDate(file.lastmod, 'YYYY'),\n              month: this.getFormatedDate(file.lastmod, 'MMMM')\n            },\n            height: 90,\n            columnSpan: 0,\n            // means full width\n            newRow: true,\n            renderComponent: SeparatorVirtualGrid\n          });\n          this.lastSection = currentSection; // we keep track of the last section for the next batch\n        }\n\n        finalArray.push({\n          id: \"img-\".concat(file.fileid),\n          injected: { ...file,\n            list: this.fileList,\n            loadMore: this.getContent,\n            canLoop: false\n          },\n          width: 256,\n          height: 256,\n          columnSpan: 1,\n          renderComponent: File\n        });\n        return finalArray;\n      });\n    },\n\n    // is current folder empty?\n    isEmpty() {\n      return this.fileList.length === 0;\n    }\n\n  },\n  watch: {\n    async onlyFavorites() {\n      // reset component\n      this.resetState();\n      this.getContent();\n    },\n\n    async mimesType() {\n      // reset component\n      this.resetState();\n      this.getContent();\n    }\n\n  },\n\n  beforeMount() {\n    this.getContent();\n  },\n\n  beforeDestroy() {\n    // cancel any pending requests\n    if (this.cancelRequest) {\n      this.cancelRequest('Changed view');\n    }\n\n    this.resetState();\n  },\n\n  methods: {\n    /** Return next batch of data depending on global offset\n     * @param {boolean} doReturn Returns a Promise with the list instead of a boolean\n     * @returns {Promise<boolean>} Returns a Promise with a boolean that stops infinite loading\n     */\n    async getContent(doReturn) {\n      if (this.done) {\n        return Promise.resolve(true);\n      } // cancel any pending requests\n\n\n      if (this.cancelRequest) {\n        this.cancelRequest('Changed view');\n      } // if we don't already have some cached data let's show a loader\n\n\n      if (this.timeline.length === 0) {\n        this.$emit('update:loading', true);\n      } // done loading even with errors\n\n\n      const {\n        request,\n        cancel\n      } = cancelableRequest(getPhotos);\n      this.cancelRequest = cancel;\n      const numberOfImagesPerBatch = this.gridConfig.count * 5; // loading 5 rows\n\n      try {\n        // Load next batch of images\n        const files = await request(this.onlyFavorites, {\n          page: this.page,\n          perPage: numberOfImagesPerBatch,\n          mimesType: this.mimesType\n        }); // If we get less files than requested that means we got to the end\n\n        if (files.length !== numberOfImagesPerBatch) {\n          this.done = true;\n        }\n\n        this.$store.dispatch('updateTimeline', files);\n        this.$store.dispatch('appendFiles', files);\n        this.page += 1;\n\n        if (doReturn) {\n          return Promise.resolve(files);\n        }\n\n        return Promise.resolve(false);\n      } catch (error) {\n        if (error.response && error.response.status) {\n          if (error.response.status === 404) {\n            this.error = 404;\n            setTimeout(() => {\n              this.$router.push({\n                name: this.$route.name\n              });\n            }, 3000);\n          } else {\n            this.error = error;\n          }\n        } // cancelled request, moving on...\n\n\n        console.error('Error fetching timeline', error);\n        return Promise.resolve(true);\n      } finally {\n        // done loading even with errors\n        this.$emit('update:loading', false);\n        this.cancelRequest = null;\n      }\n    },\n\n    /**\n     * Reset this component data to a pristine state\n     */\n    resetState() {\n      this.$store.dispatch('resetTimeline');\n      this.done = false;\n      this.error = null;\n      this.page = 0;\n      this.lastSection = '';\n      this.$emit('update:loading', true);\n      this.$refs.virtualgrid.resetGrid();\n    },\n\n    getFormatedDate(string, format) {\n      return moment(string).format(format);\n    }\n\n  }\n};","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".loader {\\n  display: grid;\\n  height: 60px;\\n}\\n\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".grid-title[data-v-39804afc] {\\n  grid-column: 1/8;\\n  padding: 48px 0 12px 0;\\n  margin: 0;\\n}\\n.grid-title span[data-v-39804afc] {\\n    font-weight: normal;\\n}\\n.grid-title.first-title[data-v-39804afc] {\\n    padding: 0 0 12px 0;\\n}\\n\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"@media (min-width: 0px) and (max-width: 400px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 8px 256px 8px;\\n}\\n}\\n@media (min-width: 400px) and (max-width: 700px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 8px 256px 8px;\\n}\\n}\\n@media (min-width: 700px) and (max-width: 1024px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 44px 256px 44px;\\n}\\n}\\n@media (min-width: 1024px) and (max-width: 1280px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 44px 256px 44px;\\n}\\n}\\n@media (min-width: 1280px) and (max-width: 1440px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 66px 256px 66px;\\n}\\n}\\n@media (min-width: 1440px) and (max-width: 1600px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 66px 256px 66px;\\n}\\n}\\n@media (min-width: 1600px) and (max-width: 2048px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 66px 256px 66px;\\n}\\n}\\n@media (min-width: 2048px) and (max-width: 2560px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 88px 256px 88px;\\n}\\n}\\n@media (min-width: 2560px) and (max-width: 3440px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 88px 256px 88px;\\n}\\n}\\n@media (min-width: 3440px) {\\n.grid-container[data-v-e945440a] {\\n    padding: 0px 88px 256px 88px;\\n}\\n}\\n\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Loader.vue?vue&type=style&index=0&lang=scss&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorVirtualGrid.vue?vue&type=style&index=0&id=39804afc&lang=scss&scoped=true&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Timeline.vue?vue&type=style&index=0&id=e945440a&lang=scss&scoped=true&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"loader\" },\n    [_vm._t(\"icon\", [_c(\"span\", { staticClass: \"icon-loading\" })])],\n    2\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"h2\",\n    { staticClass: \"grid-title\", style: { height: _vm.item.height + \"px\" } },\n    [\n      _vm._v(\"\\n\\t\" + _vm._s(_vm.item.injected.month) + \"\\n\\t\"),\n      _c(\"span\", [_vm._v(_vm._s(_vm.item.injected.year))])\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm.error === 404\n    ? _c(\"EmptyContent\", { attrs: { \"illustration-name\": \"folder\" } }, [\n        _vm._v(\n          \"\\n\\t\" + _vm._s(_vm.t(\"photos\", \"This folder does not exists\")) + \"\\n\"\n        )\n      ])\n    : _vm.error\n    ? _c(\"EmptyContent\", [\n        _vm._v(\"\\n\\t\" + _vm._s(_vm.t(\"photos\", \"An error occurred\")) + \"\\n\")\n      ])\n    : !_vm.loading\n    ? _c(\n        \"div\",\n        [\n          _vm.isEmpty\n            ? _c(\"Navigation\", {\n                key: \"navigation\",\n                attrs: {\n                  basename: _vm.path,\n                  filename: \"/\",\n                  \"root-title\": _vm.rootTitle\n                }\n              })\n            : _vm._e(),\n          _vm._v(\" \"),\n          _vm.isEmpty\n            ? _c(\"EmptyContent\", { attrs: { \"illustration-name\": \"empty\" } }, [\n                _vm._v(\n                  \"\\n\\t\\t\" +\n                    _vm._s(_vm.t(\"photos\", \"No photos in here\")) +\n                    \"\\n\\t\"\n                )\n              ])\n            : _vm._e(),\n          _vm._v(\" \"),\n          _c(\n            \"div\",\n            { staticClass: \"grid-container\" },\n            [\n              _c(\"VirtualGrid\", {\n                ref: \"virtualgrid\",\n                attrs: {\n                  items: _vm.contentList,\n                  \"update-function\": _vm.getContent,\n                  \"get-column-count\": function() {\n                    return _vm.gridConfig.count\n                  },\n                  \"get-grid-gap\": function() {\n                    return _vm.gridConfig.gap\n                  },\n                  \"update-trigger-margin\": 700,\n                  loader: _vm.loaderComponent\n                }\n              })\n            ],\n            1\n          )\n        ],\n        1\n      )\n    : _vm._e()\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./Loader.vue?vue&type=template&id=04a0d67a&\"\nimport script from \"./Loader.vue?vue&type=script&lang=js&\"\nexport * from \"./Loader.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Loader.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/var/www/html/nextcloud/apps/photos/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('04a0d67a')) {\n      api.createRecord('04a0d67a', component.options)\n    } else {\n      api.reload('04a0d67a', component.options)\n    }\n    module.hot.accept(\"./Loader.vue?vue&type=template&id=04a0d67a&\", function () {\n      api.rerender('04a0d67a', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/components/Loader.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Loader.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Loader.vue?vue&type=script&lang=js&\"","export * from \"-!../../node_modules/style-loader/dist/cjs.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Loader.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Loader.vue?vue&type=template&id=04a0d67a&\"","import { render, staticRenderFns } from \"./SeparatorVirtualGrid.vue?vue&type=template&id=39804afc&scoped=true&\"\nimport script from \"./SeparatorVirtualGrid.vue?vue&type=script&lang=js&\"\nexport * from \"./SeparatorVirtualGrid.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SeparatorVirtualGrid.vue?vue&type=style&index=0&id=39804afc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"39804afc\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/var/www/html/nextcloud/apps/photos/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('39804afc')) {\n      api.createRecord('39804afc', component.options)\n    } else {\n      api.reload('39804afc', component.options)\n    }\n    module.hot.accept(\"./SeparatorVirtualGrid.vue?vue&type=template&id=39804afc&scoped=true&\", function () {\n      api.rerender('39804afc', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/components/SeparatorVirtualGrid.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorVirtualGrid.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorVirtualGrid.vue?vue&type=script&lang=js&\"","export * from \"-!../../node_modules/style-loader/dist/cjs.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorVirtualGrid.vue?vue&type=style&index=0&id=39804afc&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorVirtualGrid.vue?vue&type=template&id=39804afc&scoped=true&\"","/**\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst request = require('webdav/dist/node/request');\n\nconst oldPrepareRequestOptions = request.prepareRequestOptions; // While we wait for official cancellable webdav requests\n// https://github.com/perry-mitchell/webdav-client/issues/179\n// let's properly forward our axios options through webdav to axios\n\nrequest.prepareRequestOptions = function (requestOptions, methodOptions) {\n  // add our cancelToken support\n  if (methodOptions.cancelToken && typeof methodOptions.cancelToken === 'object') {\n    requestOptions.cancelToken = methodOptions.cancelToken;\n  } // exploit old method\n\n\n  oldPrepareRequestOptions(requestOptions, methodOptions); // allow us to override the request method\n\n  if (methodOptions.method && typeof methodOptions.method === 'string') {\n    requestOptions.method = methodOptions.method;\n  }\n};\n\nmodule.exports = request;","/**\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport webdav from 'webdav';\nimport axios from '@nextcloud/axios';\nimport parseUrl from 'url-parse';\nimport { generateRemoteUrl } from '@nextcloud/router'; // force our axios\n\nconst patcher = webdav.getPatcher();\npatcher.patch('request', axios); // init webdav client on default dav endpoint\n\nconst remote = generateRemoteUrl('dav');\nconst client = webdav.createClient(remote);\nexport const remotePath = parseUrl(remote).pathname;\nexport default client;","/**\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst props = \"\\n\\t<oc:fileid />\\n\\t<d:getlastmodified />\\n\\t<d:getetag />\\n\\t<d:getcontenttype />\\n\\t<d:getcontentlength />\\n\\t<nc:has-preview />\\n\\t<oc:favorite />\\n\\t<d:resourcetype />\";\nexport { props };\nexport default \"<?xml version=\\\"1.0\\\"?>\\n\\t\\t\\t<d:propfind xmlns:d=\\\"DAV:\\\"\\n\\t\\t\\t\\txmlns:oc=\\\"http://owncloud.org/ns\\\"\\n\\t\\t\\t\\txmlns:nc=\\\"http://nextcloud.org/ns\\\"\\n\\t\\t\\t\\txmlns:ocs=\\\"http://open-collaboration-services.org/ns\\\">\\n\\t\\t\\t\\t<d:prop>\\n\\t\\t\\t\\t\\t\".concat(props, \"\\n\\t\\t\\t\\t</d:prop>\\n\\t\\t\\t</d:propfind>\");","/**\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { genFileInfo } from '../utils/fileUtils';\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { allMimes } from './AllowedMimes';\nimport client from './DavClient';\nimport { props } from './DavRequest';\nimport { sizes } from '../assets/grid-sizes';\n/**\n * List files from a folder and filter out unwanted mimes\n *\n * @param {boolean} [onlyFavorites=false] not used\n * @param {Object} [options] used for the cancellable requests\n * @param {number} [options.page=0] which page to start (starts at 0)\n * @param {number} [options.perPage] how many to display per page default is 5 times the max number per line from the grid-sizes config file\n * @param {boolean} [options.full=false] get full data of the files\n * @returns {Array} the file list\n */\n\nexport default async function (onlyFavorites = false, options = {}) {\n  // default function options\n  options = Object.assign({}, {\n    page: 0,\n    // start at the first page\n    perPage: sizes.max.count * 10,\n    // ten rows of the max width\n    mimesType: allMimes // all mimes types\n\n  }, options);\n  const prefixPath = \"/files/\".concat(getCurrentUser().uid); // generating the search or condition\n  // based on the allowed mimetypes\n\n  const orMime = options.mimesType.reduce((str, mime) => \"\".concat(str, \"\\n\\t\\t<d:eq>\\n\\t\\t\\t<d:prop>\\n\\t\\t\\t\\t<d:getcontenttype/>\\n\\t\\t\\t</d:prop>\\n\\t\\t\\t<d:literal>\").concat(mime, \"</d:literal>\\n\\t\\t</d:eq>\\n\\t\"), '');\n  const eqFavorites = onlyFavorites ? \"<d:eq>\\n\\t\\t\\t\\t<d:prop>\\n\\t\\t\\t\\t\\t<oc:favorite/>\\n\\t\\t\\t\\t</d:prop>\\n\\t\\t\\t\\t<d:literal>1</d:literal>\\n\\t\\t\\t</d:eq>\" : '';\n  options = Object.assign({\n    method: 'SEARCH',\n    headers: {\n      'content-Type': 'text/xml'\n    },\n    data: \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\\t\\t\\t<d:searchrequest xmlns:d=\\\"DAV:\\\"\\n\\t\\t\\t\\txmlns:oc=\\\"http://owncloud.org/ns\\\"\\n\\t\\t\\t\\txmlns:nc=\\\"http://nextcloud.org/ns\\\"\\n\\t\\t\\t\\txmlns:ns=\\\"https://github.com/icewind1991/SearchDAV/ns\\\"\\n\\t\\t\\t\\txmlns:ocs=\\\"http://open-collaboration-services.org/ns\\\">\\n\\t\\t\\t\\t<d:basicsearch>\\n\\t\\t\\t\\t\\t<d:select>\\n\\t\\t\\t\\t\\t\\t<d:prop>\\n\\t\\t\\t\\t\\t\\t\\t\".concat(props, \"\\n\\t\\t\\t\\t\\t\\t</d:prop>\\n\\t\\t\\t\\t\\t</d:select>\\n\\t\\t\\t\\t\\t<d:from>\\n\\t\\t\\t\\t\\t\\t<d:scope>\\n\\t\\t\\t\\t\\t\\t\\t<d:href>\").concat(prefixPath, \"</d:href>\\n\\t\\t\\t\\t\\t\\t\\t<d:depth>infinity</d:depth>\\n\\t\\t\\t\\t\\t\\t</d:scope>\\n\\t\\t\\t\\t\\t</d:from>\\n\\t\\t\\t\\t\\t<d:where>\\n\\t\\t\\t\\t\\t\\t<d:and>\\n\\t\\t\\t\\t\\t\\t\\t<d:or>\\n\\t\\t\\t\\t\\t\\t\\t\\t\").concat(orMime, \"\\n\\t\\t\\t\\t\\t\\t\\t</d:or>\\n\\t\\t\\t\\t\\t\\t\\t\").concat(eqFavorites, \"\\n\\t\\t\\t\\t\\t\\t\\t<d:eq>\\n\\t\\t\\t\\t\\t\\t\\t\\t<d:prop>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<oc:owner-id/>\\n\\t\\t\\t\\t\\t\\t\\t\\t</d:prop>\\n\\t\\t\\t\\t\\t\\t\\t\\t<d:literal>\").concat(getCurrentUser().uid, \"</d:literal>\\n\\t\\t\\t\\t\\t\\t\\t</d:eq>\\n\\t\\t\\t\\t\\t\\t</d:and>\\n\\t\\t\\t\\t\\t</d:where>\\n\\t\\t\\t\\t\\t<d:orderby>\\n\\t\\t\\t\\t\\t\\t<d:order>\\n\\t\\t\\t\\t\\t\\t\\t<d:prop><d:getlastmodified/></d:prop>\\n\\t\\t\\t\\t\\t\\t\\t<d:descending/>\\n\\t\\t\\t\\t\\t\\t</d:order>\\n\\t\\t\\t\\t\\t</d:orderby>\\n\\t\\t\\t\\t\\t<d:limit>\\n\\t\\t\\t\\t\\t\\t<d:nresults>\").concat(options.perPage, \"</d:nresults>\\n\\t\\t\\t\\t\\t\\t<ns:firstresult>\").concat(options.page * options.perPage, \"</ns:firstresult>\\n\\t\\t\\t\\t\\t</d:limit>\\n\\t\\t\\t\\t</d:basicsearch>\\n\\t\\t\\t</d:searchrequest>\"),\n    deep: true,\n    details: true\n  }, options);\n  const response = await client.getDirectoryContents('', options);\n  return response.data.map(data => genFileInfo(data)) // remove prefix path from full file path\n  .map(data => Object.assign({}, data, {\n    filename: data.filename.replace(prefixPath, '')\n  }));\n}","import { render, staticRenderFns } from \"./Timeline.vue?vue&type=template&id=e945440a&scoped=true&\"\nimport script from \"./Timeline.vue?vue&type=script&lang=js&\"\nexport * from \"./Timeline.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Timeline.vue?vue&type=style&index=0&id=e945440a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e945440a\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/var/www/html/nextcloud/apps/photos/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('e945440a')) {\n      api.createRecord('e945440a', component.options)\n    } else {\n      api.reload('e945440a', component.options)\n    }\n    module.hot.accept(\"./Timeline.vue?vue&type=template&id=e945440a&scoped=true&\", function () {\n      api.rerender('e945440a', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/Timeline.vue\"\nexport default component.exports","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Timeline.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Timeline.vue?vue&type=script&lang=js&\"","export * from \"-!../../node_modules/style-loader/dist/cjs.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js??ref--1-3!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Timeline.vue?vue&type=style&index=0&id=e945440a&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Timeline.vue?vue&type=template&id=e945440a&scoped=true&\""],"mappings":";;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChCA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrSA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACbA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACfA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACpEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACvCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACvCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AChCA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACnEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACvCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}