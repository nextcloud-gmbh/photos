{"version":3,"file":"photos-src_mixins_FetchFilesMixin_js-node_modules_vue-material-design-icons_ImagePlus_vue-src_compon-c78281.js?v=d7831146d7c5a12d02f0","mappings":"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","sources":["webpack:///photos/src/services/PhotoSearch.js","webpack:///photos/src/mixins/FetchFilesMixin.js","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=style&index=0&id=0282e6b2&lang=scss&scoped=true&","webpack:///photos/node_modules/vue-material-design-icons/AlertCircle.vue","webpack:///photos/node_modules/vue-material-design-icons/AlertCircle.vue?vue&type=script&lang=js&","webpack://photos/./node_modules/vue-material-design-icons/AlertCircle.vue?489a","webpack:///photos/node_modules/vue-material-design-icons/AlertCircle.vue?vue&type=template&id=2a2453f8&","webpack:///photos/node_modules/vue-material-design-icons/FolderMultipleImage.vue","webpack:///photos/node_modules/vue-material-design-icons/FolderMultipleImage.vue?vue&type=script&lang=js&","webpack://photos/./node_modules/vue-material-design-icons/FolderMultipleImage.vue?f9dd","webpack:///photos/node_modules/vue-material-design-icons/FolderMultipleImage.vue?vue&type=template&id=497205fa&","webpack:///photos/node_modules/vue-material-design-icons/ImagePlus.vue","webpack:///photos/node_modules/vue-material-design-icons/ImagePlus.vue?vue&type=script&lang=js&","webpack://photos/./node_modules/vue-material-design-icons/ImagePlus.vue?8b12","webpack:///photos/node_modules/vue-material-design-icons/ImagePlus.vue?vue&type=template&id=6b6ee9f3&","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=template&id=0282e6b2&scoped=true&","webpack:///photos/src/components/Collection/CollectionContent.vue","webpack:///photos/src/components/Collection/CollectionContent.vue?vue&type=script&lang=js&","webpack://photos/./src/components/Collection/CollectionContent.vue?3caf","webpack://photos/./src/components/Collection/CollectionContent.vue?d20d"],"sourcesContent":["/**\r\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\r\n *\r\n * @author John Molakvoæ <skjnldsv@protonmail.com>\r\n *\r\n * @license AGPL-3.0-or-later\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Affero General Public License as\r\n * published by the Free Software Foundation, either version 3 of the\r\n * License, or (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r\n * GNU Affero General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n */\r\n\r\nimport { genFileInfo } from '../utils/fileUtils.js'\r\nimport { getCurrentUser } from '@nextcloud/auth'\r\nimport { allMimes } from './AllowedMimes.js'\r\nimport client from './DavClient.js'\r\nimport { props } from './DavRequest.js'\r\nimport moment from '@nextcloud/moment'\r\n\r\n/**\r\n * List files from a folder and filter out unwanted mimes\r\n *\r\n * @param {object} path the lookup path\r\n * @param {object} [options] used for the cancellable requests\r\n * @param {number} [options.firstResult=0] Index of the first result that we want (starts at 0)\r\n * @param {number} [options.nbResults=200] The number of file to fetch\r\n * @param {string[]} [options.mimesType=allMimes] Mime type of the files\r\n * @param {boolean} [options.full=false] get full data of the files\r\n * @param {boolean} [options.onThisDay=false] get only items from this day of year\r\n * @param {boolean} [options.onlyFavorites=false] get only favorite items\r\n * @return {Promise<object[]>} the file list\r\n */\r\nexport default async function(path = '', options = {}) {\r\n\t// default function options\r\n\toptions = {\r\n\t\tfirstResult: 0,\r\n\t\tnbResults: 200,\r\n\t\tmimesType: allMimes,\r\n\t\tonThisDay: false,\r\n\t\tonlyFavorites: false,\r\n\t\t...options,\r\n\t}\r\n\r\n\tconst prefixPath = `/files/${getCurrentUser().uid}`\r\n\r\n\t// generating the search or condition\r\n\t// based on the allowed mimetypes\r\n\tconst orMime = options.mimesType.reduce((str, mime) => `${str}\r\n\t\t<d:eq>\r\n\t\t\t<d:prop>\r\n\t\t\t\t<d:getcontenttype/>\r\n\t\t\t</d:prop>\r\n\t\t\t<d:literal>${mime}</d:literal>\r\n\t\t</d:eq>\r\n\t`, '')\r\n\r\n\tconst eqFavorites = options.onlyFavorites\r\n\t\t? `<d:eq>\r\n\t\t\t\t<d:prop>\r\n\t\t\t\t\t<oc:favorite/>\r\n\t\t\t\t</d:prop>\r\n\t\t\t\t<d:literal>1</d:literal>\r\n\t\t\t</d:eq>`\r\n\t\t: ''\r\n\r\n\tconst onThisDay = options.onThisDay\r\n\t\t? `<d:or>${Array(20).fill(1)\r\n\t\t\t.map((_, years) => {\r\n\t\t\t\tconst start = moment(Date.now()).startOf('day').subtract(3, 'd').subtract(years + 1, 'y')\r\n\t\t\t\tconst end = moment(Date.now()).endOf('day').add(3, 'd').subtract(years + 1, 'y')\r\n\t\t\t\treturn `<d:and>\r\n\t\t\t\t<d:gt>\r\n\t\t\t\t\t<d:prop>\r\n\t\t\t\t\t\t<d:getlastmodified />\r\n\t\t\t\t\t</d:prop>\r\n\t\t\t\t\t<d:literal>${start.format(moment.defaultFormatUtc)}</d:literal>\r\n\t\t\t\t</d:gt>\r\n\t\t\t\t<d:lt>\r\n\t\t\t\t\t<d:prop>\r\n\t\t\t\t\t\t<d:getlastmodified />\r\n\t\t\t\t\t</d:prop>\r\n\t\t\t\t\t<d:literal>${end.format(moment.defaultFormatUtc)}</d:literal>\r\n\t\t\t\t</d:lt>\r\n\t\t\t</d:and>`\r\n\t\t\t}).join('\\n')}</d:or>`\r\n\t\t: ''\r\n\r\n\toptions = Object.assign({\r\n\t\tmethod: 'SEARCH',\r\n\t\theaders: {\r\n\t\t\t'content-Type': 'text/xml',\r\n\t\t},\r\n\t\tdata: `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n\t\t\t<d:searchrequest xmlns:d=\"DAV:\"\r\n\t\t\t\txmlns:oc=\"http://owncloud.org/ns\"\r\n\t\t\t\txmlns:nc=\"http://nextcloud.org/ns\"\r\n\t\t\t\txmlns:ns=\"https://github.com/icewind1991/SearchDAV/ns\"\r\n\t\t\t\txmlns:ocs=\"http://open-collaboration-services.org/ns\">\r\n\t\t\t\t<d:basicsearch>\r\n\t\t\t\t\t<d:select>\r\n\t\t\t\t\t\t<d:prop>\r\n\t\t\t\t\t\t\t${props}\r\n\t\t\t\t\t\t</d:prop>\r\n\t\t\t\t\t</d:select>\r\n\t\t\t\t\t<d:from>\r\n\t\t\t\t\t\t<d:scope>\r\n\t\t\t\t\t\t\t<d:href>${prefixPath}/${path}</d:href>\r\n\t\t\t\t\t\t\t<d:depth>infinity</d:depth>\r\n\t\t\t\t\t\t</d:scope>\r\n\t\t\t\t\t</d:from>\r\n\t\t\t\t\t<d:where>\r\n\t\t\t\t\t\t<d:and>\r\n\t\t\t\t\t\t\t<d:or>\r\n\t\t\t\t\t\t\t\t${orMime}\r\n\t\t\t\t\t\t\t</d:or>\r\n\t\t\t\t\t\t\t${eqFavorites}\r\n\t\t\t\t\t\t\t${onThisDay}\r\n\t\t\t\t\t\t</d:and>\r\n\t\t\t\t\t</d:where>\r\n\t\t\t\t\t<d:orderby>\r\n\t\t\t\t\t\t<d:order>\r\n\t\t\t\t\t\t\t<d:prop><d:getlastmodified/></d:prop>\r\n\t\t\t\t\t\t\t<d:descending/>\r\n\t\t\t\t\t\t</d:order>\r\n\t\t\t\t\t</d:orderby>\r\n\t\t\t\t\t<d:limit>\r\n\t\t\t\t\t\t<d:nresults>${options.nbResults}</d:nresults>\r\n\t\t\t\t\t\t<ns:firstresult>${options.firstResult}</ns:firstresult>\r\n\t\t\t\t\t</d:limit>\r\n\t\t\t\t</d:basicsearch>\r\n\t\t\t</d:searchrequest>`,\r\n\t\tdeep: true,\r\n\t\tdetails: true,\r\n\t}, options)\r\n\r\n\tconst response = await client.getDirectoryContents('', options)\r\n\r\n\treturn response.data.map(data => genFileInfo(data))\r\n}\r\n","/**\r\n * @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\r\n *\r\n * @author Louis Chemineau <louis@chmn.me>\r\n *\r\n * @license AGPL-3.0-or-later\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Affero General Public License as\r\n * published by the Free Software Foundation, either version 3 of the\r\n * License, or (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r\n * GNU Affero General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\r\n *\r\n */\r\n\r\nimport logger from '../services/logger.js'\r\nimport getPhotos from '../services/PhotoSearch.js'\r\nimport SemaphoreWithPriority from '../utils/semaphoreWithPriority.js'\r\nimport AbortControllerMixin from './AbortControllerMixin.js'\r\n\r\nexport default {\r\n\tname: 'FetchFilesMixin',\r\n\r\n\tmixins: [\r\n\t\tAbortControllerMixin,\r\n\t],\r\n\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\terrorFetchingFiles: null,\r\n\t\t\tloadingFiles: false,\r\n\t\t\tdoneFetchingFiles: false,\r\n\t\t\tsemaphore: new SemaphoreWithPriority(30),\r\n\t\t\tfetchSemaphore: new SemaphoreWithPriority(1),\r\n\t\t\tsemaphoreSymbol: null,\r\n\t\t\tfetchedFileIds: [],\r\n\t\t}\r\n\t},\r\n\r\n\twatch: {\r\n\t\t$route() {\r\n\t\t\tthis.resetFetchFilesState()\r\n\t\t},\r\n\t},\r\n\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * @param {string} path - Path to pass to getPhotos.\r\n\t\t * @param {object} options - Options to pass to getPhotos.\r\n\t\t * @param {string[]} [blacklist=[]] - Array of ids to filter out.\r\n\t\t * @return {Promise<string[]>} - The next batch of data depending on global offset.\r\n\t\t */\r\n\t\tasync fetchFiles(path = '', options = {}, blacklist = []) {\r\n\t\t\tif (this.doneFetchingFiles || this.loadingFiles) {\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\r\n\t\t\tconst semaphoreSymbol = await this.semaphore.acquire(() => 0, 'fetchFiles')\r\n\t\t\tconst fetchSemaphoreSymbol = await this.fetchSemaphore.acquire()\r\n\r\n\t\t\ttry {\r\n\t\t\t\tthis.errorFetchingFiles = null\r\n\t\t\t\tthis.loadingFiles = true\r\n\t\t\t\tthis.semaphoreSymbol = semaphoreSymbol\r\n\r\n\t\t\t\tconst numberOfImagesPerBatch = 200\r\n\r\n\t\t\t\t// Load next batch of images\r\n\t\t\t\tconst fetchedFiles = await getPhotos(path, {\r\n\t\t\t\t\tfirstResult: this.fetchedFileIds.length,\r\n\t\t\t\t\tnbResults: numberOfImagesPerBatch,\r\n\t\t\t\t\t...options,\r\n\t\t\t\t\tsignal: this.abortController.signal,\r\n\t\t\t\t})\r\n\r\n\t\t\t\t// If we get less files than requested that means we got to the end\r\n\t\t\t\tif (fetchedFiles.length !== numberOfImagesPerBatch) {\r\n\t\t\t\t\tthis.doneFetchingFiles = true\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst fileIds = fetchedFiles\r\n\t\t\t\t\t.map(file => file.fileid)\r\n\t\t\t\t\t.filter(fileId => !this.fetchedFileIds.includes(fileId)) // Filter to prevent duplicate fileIds.\r\n\r\n\t\t\t\tthis.fetchedFileIds.push(\r\n\t\t\t\t\t...fileIds\r\n\t\t\t\t\t\t.map((fileId) => fileId.toString())\r\n\t\t\t\t\t\t.filter((fileId) => !blacklist.includes(fileId))\r\n\t\t\t\t)\r\n\r\n\t\t\t\tthis.$store.dispatch('appendFiles', fetchedFiles)\r\n\r\n\t\t\t\tlogger.debug(`[FetchFilesMixin] Fetched ${fileIds.length} new files: `, fileIds)\r\n\r\n\t\t\t\treturn fileIds\r\n\t\t\t} catch (error) {\r\n\t\t\t\tif (error.response?.status === 404) {\r\n\t\t\t\t\tthis.errorFetchingFiles = 404\r\n\t\t\t\t} else if (error.code === 'ERR_CANCELED') {\r\n\t\t\t\t\treturn []\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.errorFetchingFiles = error\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// cancelled request, moving on...\r\n\t\t\t\tlogger.error('Error fetching files', { error })\r\n\t\t\t\tconsole.error(error)\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loadingFiles = false\r\n\t\t\t\tthis.semaphore.release(semaphoreSymbol)\r\n\t\t\t\tthis.fetchSemaphore.release(fetchSemaphoreSymbol)\r\n\t\t\t}\r\n\r\n\t\t\treturn []\r\n\t\t},\r\n\r\n\t\tresetFetchFilesState() {\r\n\t\t\tthis.doneFetchingFiles = false\r\n\t\t\tthis.errorFetchingFiles = null\r\n\t\t\tthis.loadingFiles = false\r\n\t\t\tthis.fetchedFileIds = []\r\n\t\t},\r\n\t},\r\n}\r\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".collection[data-v-0282e6b2]{display:flex;flex-direction:column}.collection__media[data-v-0282e6b2]{padding:0 64px}@media only screen and (max-width: 1200px){.collection__media[data-v-0282e6b2]{padding:0 4px}}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Collection/CollectionContent.vue\"],\"names\":[],\"mappings\":\"AA8IA,6BACC,YAAA,CACA,qBAAA,CAEA,oCACC,cAAA,CAEA,2CAHD,oCAIE,aAAA,CAAA\",\"sourcesContent\":[\"$sizes: (\\\"400\\\": (\\\"count\\\": 3, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"700\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 8), \\\"1024\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1280\\\": (\\\"count\\\": 4, \\\"marginTop\\\": 66, \\\"marginW\\\": 44), \\\"1440\\\": (\\\"count\\\": 5, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"1600\\\": (\\\"count\\\": 6, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2048\\\": (\\\"count\\\": 7, \\\"marginTop\\\": 88, \\\"marginW\\\": 66), \\\"2560\\\": (\\\"count\\\": 8, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"3440\\\": (\\\"count\\\": 9, \\\"marginTop\\\": 88, \\\"marginW\\\": 88), \\\"max\\\": (\\\"count\\\": 10, \\\"marginTop\\\": 88, \\\"marginW\\\": 88));\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\r\\n.collection {\\r\\n\\tdisplay: flex;\\r\\n\\tflex-direction: column;\\r\\n\\r\\n\\t&__media {\\r\\n\\t\\tpadding: 0 64px;\\r\\n\\r\\n\\t\\t@media only screen and (max-width: 1200px) {\\r\\n\\t\\t\\tpadding: 0 4px;\\r\\n\\t\\t}\\r\\n\\t}\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"!title\"\n        :aria-label=\"title\"\n        class=\"material-design-icon alert-circle-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"AlertCircleIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","import mod from \"-!../vue-loader/lib/index.js??vue-loader-options!./AlertCircle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../vue-loader/lib/index.js??vue-loader-options!./AlertCircle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlertCircle.vue?vue&type=template&id=2a2453f8&\"\nimport script from \"./AlertCircle.vue?vue&type=script&lang=js&\"\nexport * from \"./AlertCircle.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',_vm._b({staticClass:\"material-design-icon alert-circle-icon\",attrs:{\"aria-hidden\":!_vm.title,\"aria-label\":_vm.title,\"role\":\"img\"},on:{\"click\":function($event){return _vm.$emit('click', $event)}}},'span',_vm.$attrs,false),[_c('svg',{staticClass:\"material-design-icon__svg\",attrs:{\"fill\":_vm.fillColor,\"width\":_vm.size,\"height\":_vm.size,\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z\"}},[(_vm.title)?_c('title',[_vm._v(_vm._s(_vm.title))]):_vm._e()])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"!title\"\n        :aria-label=\"title\"\n        class=\"material-design-icon folder-multiple-image-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"FolderMultipleImageIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","import mod from \"-!../vue-loader/lib/index.js??vue-loader-options!./FolderMultipleImage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../vue-loader/lib/index.js??vue-loader-options!./FolderMultipleImage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FolderMultipleImage.vue?vue&type=template&id=497205fa&\"\nimport script from \"./FolderMultipleImage.vue?vue&type=script&lang=js&\"\nexport * from \"./FolderMultipleImage.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',_vm._b({staticClass:\"material-design-icon folder-multiple-image-icon\",attrs:{\"aria-hidden\":!_vm.title,\"aria-label\":_vm.title,\"role\":\"img\"},on:{\"click\":function($event){return _vm.$emit('click', $event)}}},'span',_vm.$attrs,false),[_c('svg',{staticClass:\"material-design-icon__svg\",attrs:{\"fill\":_vm.fillColor,\"width\":_vm.size,\"height\":_vm.size,\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M7,15L11.5,9L15,13.5L17.5,10.5L21,15M22,4H14L12,2H6A2,2 0 0,0 4,4V16A2,2 0 0,0 6,18H22A2,2 0 0,0 24,16V6A2,2 0 0,0 22,4M2,6H0V11H0V20A2,2 0 0,0 2,22H20V20H2V6Z\"}},[(_vm.title)?_c('title',[_vm._v(_vm._s(_vm.title))]):_vm._e()])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"!title\"\n        :aria-label=\"title\"\n        class=\"material-design-icon image-plus-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"ImagePlusIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","import mod from \"-!../vue-loader/lib/index.js??vue-loader-options!./ImagePlus.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../vue-loader/lib/index.js??vue-loader-options!./ImagePlus.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImagePlus.vue?vue&type=template&id=6b6ee9f3&\"\nimport script from \"./ImagePlus.vue?vue&type=script&lang=js&\"\nexport * from \"./ImagePlus.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('span',_vm._b({staticClass:\"material-design-icon image-plus-icon\",attrs:{\"aria-hidden\":!_vm.title,\"aria-label\":_vm.title,\"role\":\"img\"},on:{\"click\":function($event){return _vm.$emit('click', $event)}}},'span',_vm.$attrs,false),[_c('svg',{staticClass:\"material-design-icon__svg\",attrs:{\"fill\":_vm.fillColor,\"width\":_vm.size,\"height\":_vm.size,\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z\"}},[(_vm.title)?_c('title',[_vm._v(_vm._s(_vm.title))]):_vm._e()])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return ((_vm.collection === undefined && !_vm.loading) || _vm.error === 404)?_c('NcEmptyContent',{staticClass:\"empty-content-with-illustration\",attrs:{\"title\":_vm.t('photos', 'This collection does not exist')}},[_c('FolderMultipleImage',{attrs:{\"slot\":\"icon\"},slot:\"icon\"})],1):(_vm.error)?_c('NcEmptyContent',{attrs:{\"title\":_vm.t('photos', 'An error occurred')}},[_c('AlertCircle',{attrs:{\"slot\":\"icon\"},slot:\"icon\"})],1):_c('div',{staticClass:\"collection\"},[_vm._t(\"header\",null,{\"selectedFileIds\":_vm.selectedFileIds}),_vm._v(\" \"),(_vm.collectionFileIds.length === 0 && !_vm.loading)?_vm._t(\"empty-content\"):_vm._e(),_vm._v(\" \"),(_vm.collection !== undefined)?_c('FilesListViewer',{staticClass:\"collection__media\",attrs:{\"container-element\":_vm.appContent,\"file-ids\":_vm.collectionFileIds,\"base-height\":_vm.isMobile ? 120 : 200,\"loading\":_vm.loading},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar file = ref.file;\nvar visibility = ref.visibility;\nreturn _c('File',{attrs:{\"file\":_vm.files[file.id],\"allow-selection\":true,\"selected\":_vm.selection[file.id] === true,\"visibility\":visibility,\"semaphore\":_vm.semaphore},on:{\"click\":_vm.openViewer,\"select-toggled\":_vm.onFileSelectToggle}})}}],null,false,3592900521)}):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\r\n - @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\r\n -\r\n - @author Louis Chemineau <louis@chmn.me>\r\n -\r\n - @license AGPL-3.0-or-later\r\n -\r\n - This program is free software: you can redistribute it and/or modify\r\n - it under the terms of the GNU Affero General Public License as\r\n - published by the Free Software Foundation, either version 3 of the\r\n - License, or (at your option) any later version.\r\n -\r\n - This program is distributed in the hope that it will be useful,\r\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r\n - GNU Affero General Public License for more details.\r\n -\r\n - You should have received a copy of the GNU Affero General Public License\r\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\r\n -\r\n -->\r\n<template>\r\n\t<!-- Errors handlers-->\r\n\t<NcEmptyContent v-if=\"(collection === undefined && !loading) || error === 404\"\r\n\t\tclass=\"empty-content-with-illustration\"\r\n\t\t:title=\"t('photos', 'This collection does not exist')\">\r\n\t\t<FolderMultipleImage slot=\"icon\" />\r\n\t</NcEmptyContent>\r\n\t<NcEmptyContent v-else-if=\"error\" :title=\"t('photos', 'An error occurred')\">\r\n\t\t<AlertCircle slot=\"icon\" />\r\n\t</NcEmptyContent>\r\n\r\n\t<div v-else class=\"collection\">\r\n\t\t<!-- Header -->\r\n\t\t<slot class=\"collection__header\" name=\"header\" :selected-file-ids=\"selectedFileIds\" />\r\n\r\n\t\t<!-- No content -->\r\n\t\t<slot v-if=\"collectionFileIds.length === 0 && !loading\" name=\"empty-content\" />\r\n\r\n\t\t<!-- Media list -->\r\n\t\t<FilesListViewer v-if=\"collection !== undefined\"\r\n\t\t\t:container-element=\"appContent\"\r\n\t\t\tclass=\"collection__media\"\r\n\t\t\t:file-ids=\"collectionFileIds\"\r\n\t\t\t:base-height=\"isMobile ? 120 : 200\"\r\n\t\t\t:loading=\"loading\">\r\n\t\t\t<File slot-scope=\"{file, visibility}\"\r\n\t\t\t\t:file=\"files[file.id]\"\r\n\t\t\t\t:allow-selection=\"true\"\r\n\t\t\t\t:selected=\"selection[file.id] === true\"\r\n\t\t\t\t:visibility=\"visibility\"\r\n\t\t\t\t:semaphore=\"semaphore\"\r\n\t\t\t\t@click=\"openViewer\"\r\n\t\t\t\t@select-toggled=\"onFileSelectToggle\" />\r\n\t\t</FilesListViewer>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\nimport AlertCircle from 'vue-material-design-icons/AlertCircle'\r\nimport FolderMultipleImage from 'vue-material-design-icons/FolderMultipleImage'\r\n\r\nimport { NcEmptyContent, isMobile } from '@nextcloud/vue'\r\n\r\nimport FilesSelectionMixin from '../../mixins/FilesSelectionMixin.js'\r\nimport FilesListViewer from '.././FilesListViewer.vue'\r\nimport File from '.././File.vue'\r\nimport FolderIllustration from '../../assets/Illustrations/folder.svg'\r\nimport SemaphoreWithPriority from '../../utils/semaphoreWithPriority.js'\r\n\r\nexport default {\r\n\tname: 'CollectionContent',\r\n\r\n\tcomponents: {\r\n\t\tAlertCircle,\r\n\t\tFolderMultipleImage,\r\n\t\tNcEmptyContent,\r\n\t\tFilesListViewer,\r\n\t\tFile,\r\n\t},\r\n\r\n\tmixins: [\r\n\t\tFilesSelectionMixin,\r\n\t\tisMobile,\r\n\t],\r\n\r\n\tprops: {\r\n\t\tcollection: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: () => undefined,\r\n\t\t},\r\n\r\n\t\tcollectionFileIds: {\r\n\t\t\ttype: Array,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\r\n\t\tloading: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t},\r\n\r\n\t\terror: {\r\n\t\t\ttype: [Error, Number],\r\n\t\t\tdefault: null,\r\n\t\t},\r\n\r\n\t\tsemaphore: {\r\n\t\t\ttype: SemaphoreWithPriority,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t},\r\n\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tFolderIllustration,\r\n\t\t\tappContent: document.getElementById('app-content-vue'),\r\n\t\t}\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\t...mapGetters([\r\n\t\t\t'files',\r\n\t\t]),\r\n\t},\r\n\r\n\tmethods: {\r\n\t\topenViewer(fileId) {\r\n\t\t\tconst file = this.files[fileId]\r\n\t\t\tOCA.Viewer.open({\r\n\t\t\t\tfileInfo: file,\r\n\t\t\t\tlist: this.collectionFileIds.map(fileId => this.files[fileId]).filter(file => !file.sectionHeader),\r\n\t\t\t\tloadMore: file.loadMore ? async () => await file.loadMore(true) : () => [],\r\n\t\t\t\tcanLoop: file.canLoop,\r\n\t\t\t})\r\n\t\t},\r\n\t},\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.collection {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\r\n\t&__media {\r\n\t\tpadding: 0 64px;\r\n\r\n\t\t@media only screen and (max-width: 1200px) {\r\n\t\t\tpadding: 0 4px;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=script&lang=js&\"","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2[0].rules[0].use[3]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=style&index=0&id=0282e6b2&lang=scss&scoped=true&\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-2[0].rules[0].use[3]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CollectionContent.vue?vue&type=style&index=0&id=0282e6b2&lang=scss&scoped=true&\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./CollectionContent.vue?vue&type=template&id=0282e6b2&scoped=true&\"\nimport script from \"./CollectionContent.vue?vue&type=script&lang=js&\"\nexport * from \"./CollectionContent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CollectionContent.vue?vue&type=style&index=0&id=0282e6b2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0282e6b2\",\n  null\n  \n)\n\nexport default component.exports"],"names":["path","options","firstResult","nbResults","mimesType","allMimes","onThisDay","onlyFavorites","prefixPath","getCurrentUser","uid","orMime","reduce","str","mime","eqFavorites","Array","fill","map","_","years","start","moment","Date","now","startOf","subtract","end","endOf","add","format","join","Object","assign","method","headers","data","props","deep","details","client","response","genFileInfo","name","mixins","AbortControllerMixin","errorFetchingFiles","loadingFiles","doneFetchingFiles","semaphore","SemaphoreWithPriority","fetchSemaphore","semaphoreSymbol","fetchedFileIds","watch","$route","this","resetFetchFilesState","methods","fetchFiles","blacklist","acquire","fetchSemaphoreSymbol","numberOfImagesPerBatch","getPhotos","length","signal","abortController","fetchedFiles","fileIds","file","fileid","filter","fileId","includes","push","toString","$store","dispatch","logger","status","code","error","console","release","___CSS_LOADER_EXPORT___","module","id","emits","title","type","String","fillColor","default","size","Number","_vm","_h","$createElement","_c","_self","_b","staticClass","attrs","on","$event","$emit","$attrs","_v","_s","_e","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","collection","loading","t","slot","_t","selectedFileIds","collectionFileIds","appContent","isMobile","scopedSlots","_u","key","fn","ref","visibility","files","selection","openViewer","onFileSelectToggle"],"sourceRoot":""}